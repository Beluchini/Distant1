@page "/"
@using Newtonsoft.Json
@rendermode InteractiveServer
<PageTitle>Авторемонт</PageTitle>
<h1 class="tab" >АвтоРемонт</h1>
<div>
    <div>
        <input type="text" @bind="NewService"/>
        <button @onclick="AddFile">Добавить</button>
        <button @onclick="SaveFile">Сохранить</button>
    </div>
</div>
<div>
    <div>
        <div class="view">
            @foreach (var item in list)
            {
                <div href="" class="tabUp">
                    <h1 class="itemu">@item</h1>
                <div>
                    <button @onclick="() => RemoveKeep(item)" class="tabDown"><h3>Удалить</h3></button>
                </div>
                </div>
            }
        </div>
    </div>
</div>
@code
{
    public string NewService { get; set; }
    public IList<string> list = new List<string>();
    protected override void OnInitialized()
    {
        OpenFile();
    }

    public void OpenFile()
    {
        if (File.Exists("servic.json"))
        {
            string json = File.ReadAllText(path: "servic.json");
            list = JsonConvert.DeserializeObject<List<string>>(json);
        }
        else
        {
            SaveFile();
        }
    }

    public void SaveFile()
    {
        var json = JsonConvert.SerializeObject(list);
        File.WriteAllText("servic.json", json);
    }
    private void RemoveKeep(string item)
    {
        list.Remove(item);
        SaveFile();
    }
    private void AddFile()
    {
        list.Add(NewService);
        NewService = string.Empty;
        SaveFile();
    }

}
